---
import type { UlaxStanding } from "../lib/ulax";

interface Props {
  standings: UlaxStanding[];
}

const { standings } = Astro.props;

const sortedStandings = [...standings].sort((a, b) => {
  if (b.pts !== a.pts) return b.pts - a.pts;
  return (b.gf - b.ga) - (a.gf - a.ga);
});
---

<div class="overflow-x-auto">
  <table class="w-full text-sm">
    <thead>
      <tr class="border-b border-border-strong">
        <th class="pb-3 pr-3 text-left text-muted font-medium">#</th>
        <th class="pb-3 pr-4 text-left text-muted font-medium">Team</th>
        <th class="pb-3 px-2 text-center text-muted font-medium">GP</th>
        <th class="pb-3 px-2 text-center text-muted font-medium">W</th>
        <th class="pb-3 px-2 text-center text-muted font-medium">L</th>
        <th class="pb-3 px-2 text-center text-muted font-medium">T</th>
        <th class="pb-3 px-2 text-center text-gold font-medium">PTS</th>
        <th class="pb-3 px-2 text-center text-muted font-medium hidden sm:table-cell">GF</th>
        <th class="pb-3 px-2 text-center text-muted font-medium hidden sm:table-cell">GA</th>
        <th class="pb-3 pl-2 text-center text-muted font-medium hidden sm:table-cell">+/-</th>
      </tr>
    </thead>
    <tbody>
      {sortedStandings.map((team, i) => {
        const isBarbaryCoast = team.team.includes("Barbary Coast");
        const diff = team.gf - team.ga;
        return (
          <tr class:list={[
            "border-b border-border",
            isBarbaryCoast ? "bg-powder/5" : ""
          ]}>
            <td class="py-3 pr-3 font-mono text-muted tabular-nums">{i + 1}</td>
            <td class="py-3 pr-4">
              <span class:list={[isBarbaryCoast ? "text-foreground font-medium" : "text-text"]}>
                {team.team}
              </span>
              {isBarbaryCoast && <span class="ml-1.5 text-powder text-xs">‚óè</span>}
            </td>
            <td class="py-3 px-2 text-center font-mono text-muted tabular-nums">{team.gp}</td>
            <td class="py-3 px-2 text-center font-mono text-foreground tabular-nums font-medium">{team.w}</td>
            <td class="py-3 px-2 text-center font-mono text-muted tabular-nums">{team.l}</td>
            <td class="py-3 px-2 text-center font-mono text-muted tabular-nums">{team.t}</td>
            <td class="py-3 px-2 text-center font-mono text-gold tabular-nums font-semibold">{team.pts}</td>
            <td class="py-3 px-2 text-center font-mono text-muted tabular-nums hidden sm:table-cell">{team.gf}</td>
            <td class="py-3 px-2 text-center font-mono text-muted tabular-nums hidden sm:table-cell">{team.ga}</td>
            <td class:list={[
              "py-3 pl-2 text-center font-mono tabular-nums hidden sm:table-cell",
              diff > 0 ? "text-win" : diff < 0 ? "text-loss" : "text-muted"
            ]}>
              {diff > 0 ? `+${diff}` : diff}
            </td>
          </tr>
        );
      })}
    </tbody>
  </table>
</div>
