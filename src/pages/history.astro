---
import Layout from "../layouts/Layout.astro";
import type { UlaxAllDataSerialized } from "../lib/ulax";
import ulaxData from "../data/ulax.json";

const data = ulaxData as UlaxAllDataSerialized;

const bcChampionships = data.championships
  .filter((c) => c.champion.includes("Barbary Coast"))
  .sort((a, b) => b.year - a.year)
  .map((c) => ({
    season: `${c.season.charAt(0).toUpperCase() + c.season.slice(1)} ${c.year}`,
    division: c.division,
    result: "Champions",
  }));

const seasonHistory = data.barbaryCoast.seasons
  .filter((s) => !s.isChampion)
  .map((s) => ({
    season: s.season.charAt(0).toUpperCase() + s.season.slice(1),
    division: "Men's Field",
    result: s.result,
    record: `${s.wins}-${s.losses}${s.ties > 0 ? `-${s.ties}` : ""}`,
  }));

const allTime = data.barbaryCoast.allTime;
---

<Layout title="History" description="Championship history and records for Barbary Coast Lacrosse.">
  <div class="max-w-4xl mx-auto px-6 py-16">
    <!-- Back link -->
    <a href="/" class="subtle-link mb-12 inline-block">‚Üê Back</a>

    <!-- Header -->
    <header class="mb-16">
      <span class="label text-gold">[est. 2024]</span>
      <h1 class="text-4xl sm:text-5xl font-medium text-foreground mt-2 tracking-tight">History</h1>
    </header>

    <!-- All-Time Record -->
    <section class="mb-16">
      <h2 class="text-xl font-medium text-foreground mb-6">All-Time Record</h2>
      <div class="grid grid-cols-2 sm:grid-cols-4 gap-8">
        <div>
          <span class="text-4xl font-mono font-semibold text-foreground tabular-nums">{allTime.wins}</span>
          <span class="block text-sm text-muted mt-1">Wins</span>
        </div>
        <div>
          <span class="text-4xl font-mono font-semibold text-muted tabular-nums">{allTime.losses}</span>
          <span class="block text-sm text-muted mt-1">Losses</span>
        </div>
        <div>
          <span class="text-4xl font-mono font-semibold text-gold tabular-nums">{allTime.titles}</span>
          <span class="block text-sm text-muted mt-1">Titles</span>
        </div>
        <div>
          <span class="text-4xl font-mono font-semibold text-powder tabular-nums">
            {allTime.goalsFor > 0 ? `+${allTime.goalsFor - allTime.goalsAgainst}` : "0"}
          </span>
          <span class="block text-sm text-muted mt-1">Goal Diff</span>
        </div>
      </div>
    </section>

    <!-- Championships -->
    <section class="mb-16">
      <h2 class="text-xl font-medium text-foreground mb-6">Championships</h2>
      {bcChampionships.length > 0 ? (
        <div class="grid sm:grid-cols-2 gap-4">
          {bcChampionships.map((champ) => (
            <div class="card p-5 border-l-4 border-gold">
              <span class="label text-gold mb-2 block">[champion]</span>
              <span class="text-lg font-medium text-foreground block">{champ.season}</span>
              <span class="text-sm text-muted block mt-1">{champ.division}</span>
            </div>
          ))}
        </div>
      ) : (
        <p class="text-muted">No championships yet.</p>
      )}
    </section>

    <!-- Season Results -->
    <section>
      <h2 class="text-xl font-medium text-foreground mb-6">Seasons</h2>
      <div class="space-y-0">
        {[...bcChampionships, ...seasonHistory].map((season) => (
          <div class="flex items-center justify-between py-3 border-b border-border">
            <span class="font-medium text-foreground">{season.season}</span>
            <span class:list={[
              "label",
              season.result === "Champions" ? "text-gold" : "text-muted"
            ]}>
              [{season.result.toLowerCase()}]
            </span>
          </div>
        ))}
      </div>
    </section>
  </div>
</Layout>
