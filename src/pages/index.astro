---
import Layout from "../layouts/Layout.astro";
import Schedule from "../components/Schedule.astro";
import ulaxData from "../data/ulax.json";
import { manualEvents } from "../data/events";
import type { UlaxGameSerialized, UlaxAllDataSerialized } from "../lib/ulax";

const data = ulaxData as UlaxAllDataSerialized;
const season = data.currentSeason;
const seasonData = data.seasons[season];
const ulaxGames = (seasonData?.schedule ?? []) as UlaxGameSerialized[];
---

<Layout title="Home" showSectionNav={true}>
  <!-- Hero -->
  <section id="hero" class="snap-section section-full relative overflow-hidden">
    <!-- Blueprint grid background -->
    <div class="absolute inset-0 pointer-events-none" aria-hidden="true">
      <!-- Major grid lines -->
      <div class="absolute top-0 left-1/4 w-px h-full bg-powder/10"></div>
      <div class="absolute top-0 left-2/4 w-px h-full bg-powder/10"></div>
      <div class="absolute top-0 left-3/4 w-px h-full bg-powder/10"></div>
      <div class="absolute top-1/4 left-0 w-full h-px bg-powder/10"></div>
      <div class="absolute top-2/4 left-0 w-full h-px bg-powder/10"></div>
      <div class="absolute top-3/4 left-0 w-full h-px bg-powder/10"></div>
      <!-- Minor grid lines for blueprint effect -->
      <div class="absolute top-0 left-[12.5%] w-px h-full bg-powder/5"></div>
      <div class="absolute top-0 left-[37.5%] w-px h-full bg-powder/5"></div>
      <div class="absolute top-0 left-[62.5%] w-px h-full bg-powder/5"></div>
      <div class="absolute top-0 left-[87.5%] w-px h-full bg-powder/5"></div>
    </div>

    <!-- Corner reference marks -->
    <div class="absolute top-8 right-8 w-8 h-8 border-t border-r border-powder/30 hidden lg:block" aria-hidden="true"></div>
    <div class="absolute bottom-8 left-8 w-8 h-8 border-b border-l border-powder/30 hidden lg:block" aria-hidden="true"></div>

    <div class="max-w-6xl mx-auto px-6 lg:px-16 relative">
      <div>
        <!-- Technical reference number -->
        <span class="label text-powder/60 block mb-6">ref. 001</span>

        <h1 class="text-5xl sm:text-7xl lg:text-8xl font-semibold tracking-tight text-foreground">
          Barbary Coast
        </h1>

        <div class="mt-8 space-y-1">
          <p class="text-xl sm:text-2xl text-muted">San Francisco</p>
          <p class="text-xl sm:text-2xl text-muted">Men's Lacrosse</p>
        </div>

        <div class="mt-16">
          <span class="label text-gold">[est. 2024]</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Schedule Section -->
  <section id="schedule" class="snap-section section-full relative overflow-hidden">
    <!-- Diagonal lines background -->
    <div class="absolute inset-0 pointer-events-none" aria-hidden="true">
      <div class="absolute top-0 right-0 w-[1px] h-[200%] bg-gold/10 origin-top-right -rotate-45"></div>
      <div class="absolute top-0 right-[20%] w-[1px] h-[200%] bg-gold/5 origin-top-right -rotate-45"></div>
      <div class="absolute top-0 right-[40%] w-[1px] h-[200%] bg-gold/10 origin-top-right -rotate-45"></div>
      <!-- Horizontal accent -->
      <div class="absolute top-1/3 left-0 w-full h-px bg-powder/8"></div>
    </div>

    <!-- Corner mark -->
    <div class="absolute bottom-8 right-8 hidden lg:block" aria-hidden="true">
      <div class="w-6 h-6 border-b border-r border-gold/20"></div>
    </div>

    <div class="max-w-6xl mx-auto px-6 lg:px-16 relative">
      <div class="flex flex-col lg:flex-row lg:items-start gap-16">
        <!-- Left: Header -->
        <div class="lg:w-1/3 reveal">
          <span class="label text-powder">[upcoming]</span>
          <h2 class="text-foreground mt-2 text-4xl sm:text-5xl font-medium tracking-tight">Games</h2>
          <p class="text-muted mt-4 text-lg">
            Next matches for the team.
          </p>
          <a href="/schedule" class="subtle-link mt-6 inline-block">Full schedule →</a>
        </div>

        <!-- Right: Schedule cards -->
        <div class="lg:w-2/3 reveal" style="--delay: 0.1s">
          <Schedule ulaxGames={ulaxGames} events={manualEvents} barbaryCoastOnly={true} upcomingOnly={true} limit={4} />
        </div>
      </div>
    </div>
  </section>

  <!-- Practice Section -->
  <section id="practice" class="snap-section section-full bg-surface border-y border-border relative overflow-hidden">
    <!-- Geometric background - circles and arcs -->
    <div class="absolute inset-0 pointer-events-none" aria-hidden="true">
      <!-- Large arc -->
      <div class="absolute -bottom-[400px] -right-[200px] w-[600px] h-[600px] border border-powder/10 rounded-full"></div>
      <div class="absolute -bottom-[400px] -right-[200px] w-[500px] h-[500px] border border-powder/5 rounded-full"></div>
      <!-- Crosshair element -->
      <div class="absolute top-1/4 left-[15%] hidden lg:block">
        <div class="w-16 h-px bg-gold/15"></div>
        <div class="w-px h-16 bg-gold/15 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"></div>
      </div>
      <!-- Horizontal line -->
      <div class="absolute top-2/3 left-0 w-full h-px bg-gold/8"></div>
    </div>

    <div class="max-w-6xl mx-auto px-6 lg:px-16 relative">
      <div class="grid lg:grid-cols-2 gap-12">
        <div class="reveal">
          <span class="label text-gold">[weekly]</span>
          <h2 class="text-foreground mt-2 text-4xl sm:text-5xl font-medium tracking-tight">Practice</h2>

          <div class="mt-10">
            <p class="text-4xl sm:text-5xl font-medium text-foreground">
              Wednesdays
            </p>
            <p class="text-2xl text-muted mt-2">8–9 PM</p>
          </div>

          <div class="mt-8">
            <a
              href="https://www.google.com/maps/search/?api=1&query=Beach+Chalet+Fields+SF"
              target="_blank"
              rel="noopener"
              class="text-lg text-muted hover:text-foreground transition-colors"
            >
              Beach Chalet Fields, SF →
            </a>
          </div>
        </div>

        <div class="reveal flex items-center" style="--delay: 0.1s">
          <div class="card p-8 lg:p-10 w-full">
            <span class="label text-gold block mb-4">[open]</span>
            <h3 class="text-foreground text-xl font-medium">All levels welcome</h3>
            <p class="text-muted mt-3">
              New to lacrosse or played in college — just show up.
              No commitment required.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="snap-section section-full relative overflow-hidden">
    <!-- Geometric background - angular lines -->
    <div class="absolute inset-0 pointer-events-none" aria-hidden="true">
      <!-- Vertical lines -->
      <div class="absolute top-0 right-1/4 w-px h-full bg-powder/8"></div>
      <div class="absolute top-0 right-[10%] w-px h-2/3 bg-powder/5"></div>
      <!-- Angular accent -->
      <div class="absolute bottom-0 left-0 w-1/3 h-px bg-gold/10"></div>
      <div class="absolute bottom-[20%] left-0 w-px h-[20%] bg-gold/10"></div>
      <!-- Target/reference point -->
      <div class="absolute top-1/4 right-[15%] hidden lg:block">
        <div class="w-3 h-3 border border-powder/20"></div>
      </div>
    </div>

    <div class="max-w-6xl mx-auto px-6 lg:px-16 relative">
      <div class="max-w-2xl reveal">
        <span class="label text-powder">[connect]</span>
        <h2 class="text-foreground mt-2 text-4xl sm:text-5xl font-medium tracking-tight">Get in touch</h2>

        <div class="mt-12 space-y-8">
          <div>
            <span class="label text-subtle block mb-2">[email]</span>
            <a
              href="mailto:info@barbarycoastlax.com"
              class="text-2xl font-medium text-foreground hover:text-powder transition-colors"
            >
              info@barbarycoastlax.com
            </a>
          </div>

          <div>
            <span class="label text-subtle block mb-2">[instagram]</span>
            <a
              href="https://www.instagram.com/barbarycoastlc/"
              target="_blank"
              rel="noopener noreferrer"
              class="text-2xl font-medium text-foreground hover:text-gold transition-colors"
            >
              @barbarycoastlc
            </a>
          </div>
        </div>

        <div class="mt-16 pt-8 border-t border-border">
          <p class="text-muted">Est. 2024</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Marquee -->
  <div class="marquee border-t border-border py-4 bg-surface">
    <div class="marquee-content">
      {[...Array(3)].map(() => (
        <div class="flex items-center gap-12 px-6">
          <span class="label text-muted whitespace-nowrap">Barbary Coast</span>
          <span class="w-1 h-1 bg-powder"></span>
          <span class="label text-muted whitespace-nowrap">Beach Chalet Fields</span>
          <span class="w-1 h-1 bg-gold"></span>
          <span class="label text-muted whitespace-nowrap">Est. 2024</span>
          <span class="w-1 h-1 bg-powder"></span>
          <span class="label text-muted whitespace-nowrap">San Francisco</span>
          <span class="w-1 h-1 bg-gold"></span>
        </div>
      ))}
    </div>
  </div>
</Layout>

<script>
  // Section Observer for timeline navigation
  const sections = document.querySelectorAll('section[id]');
  const timelineItems = document.querySelectorAll<HTMLAnchorElement>('.timeline-item[data-section]');

  const sectionObserver = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const sectionId = entry.target.id;

          // Update timeline items
          timelineItems.forEach(item => {
            item.classList.toggle('active', item.dataset.section === sectionId);
          });
        }
      });
    },
    { threshold: 0.5 }
  );

  sections.forEach((section) => sectionObserver.observe(section));

  // Reveal animations
  const revealObserver = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const el = entry.target as HTMLElement;
          const delay = getComputedStyle(el).getPropertyValue('--delay') || '0s';
          el.style.animationDelay = delay;
          el.classList.add('visible');
          revealObserver.unobserve(el);
        }
      });
    },
    { threshold: 0.1, rootMargin: '0px 0px -80px 0px' }
  );

  document.querySelectorAll('.reveal').forEach((el) => revealObserver.observe(el));
</script>
