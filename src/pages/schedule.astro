---
import Layout from "../layouts/Layout.astro";
import ScheduleList from "../components/Schedule.astro";
import Standings from "../components/Standings.astro";
import ulaxData from "../data/ulax.json";
import { manualEvents } from "../data/events";
import type { UlaxGameSerialized, UlaxStanding, UlaxAllDataSerialized } from "../lib/ulax";

const data = ulaxData as UlaxAllDataSerialized;
const season = data.currentSeason;
const seasonData = data.seasons[season];

const ulaxGames = (seasonData?.schedule ?? []) as UlaxGameSerialized[];
const standings = (seasonData?.standings ?? []) as UlaxStanding[];
const fetchedAt = new Date(data.fetchedAt);
const seasonLabel = season.charAt(0).toUpperCase() + season.slice(1);
---

<Layout title="Schedule" description="Full schedule and standings for Barbary Coast Lacrosse.">
  <div class="max-w-4xl mx-auto px-6 py-16">
    <!-- Back link -->
    <a href="/" class="subtle-link mb-12 inline-block">‚Üê Back</a>

    <!-- Header -->
    <header class="mb-16">
      <span class="label text-powder">[{seasonLabel.toLowerCase()} 2026]</span>
      <h1 class="text-4xl sm:text-5xl font-medium text-foreground mt-2 tracking-tight">Schedule</h1>
      <p class="text-muted mt-4">
        Data from <a href="https://ulax.org/sanfrancisco/men/" target="_blank" rel="noopener" class="text-powder hover:underline">ulax.org</a>
      </p>
    </header>

    <!-- Games -->
    <section class="mb-16">
      <h2 class="text-xl font-medium text-foreground mb-6">Games</h2>
      <ScheduleList ulaxGames={ulaxGames} events={manualEvents} barbaryCoastOnly={true} />
    </section>

    <!-- Standings -->
    <section class="mb-16">
      <h2 class="text-xl font-medium text-foreground mb-6">Standings</h2>
      <Standings standings={standings} />
    </section>

    <!-- Footer -->
    <footer class="pt-8 border-t border-border">
      <p class="text-sm text-subtle">
        Updated {fetchedAt.toLocaleDateString("en-US", { month: "short", day: "numeric", year: "numeric" })}
      </p>
    </footer>
  </div>
</Layout>
